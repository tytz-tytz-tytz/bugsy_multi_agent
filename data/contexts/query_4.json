{
  "query": "медиа группы",
  "section_candidates": [
    {
      "section_id": "section_ch0681",
      "title": "Определение аудитории",
      "text": "Определение аудитории\nАудитория рассылки может быть фиксированной или динамической. Тип аудитории определяется условиями начала рассылки (см. таблицу 3).\nТаблица 3 — Определение типа аудитории в зависимости от условий начала рассылки\nФиксированная аудитория Динамическая аудитория\n• Начинать сразу после запуска рассылки\n• Начинать в заданное время\n• Начинать в заданное время и отправлять равномерно\n• Начинать при возникновении события для заданной аудитории\n• Начинать в заданное время и отправлять равномерно (аудитория из внешней системы)\n• Начинать при выставлении тега\n• Начинать при возникновении события\n• Начинать при получении ключевого слова\nДинамическая аудитория формируется в ходе рассылки — по мере того, как выставляются теги, генерируются события или клиент отправляет ключевое слово. Как- то ограничить ее нельзя.\nФиксированная аудитория задается до первого запуска рассылки (в состоянии «Не запущена», см. раздел\nВозможные состояния рассылки\n). После запуска рассылки изменить аудиторию полностью или удалить одного из клиентов нельзя. При необходимости запуска на другую аудиторию клиентов рассылку необходимо клонировать, затем задать новую аудиторию, см. подробнее в разделе\nИзменение условий начала и аудитории для запущенной рассылки\n.\nКроме того, для рассылок с фиксированной аудиторией (не по событию) возможен только один запуск рассылки. После того, как рассылка будет запущена и начнется для всех клиентов, она перейдет в пассивный режим. Начать ее заново (перевести в активный режим) нельзя: при попытке выполнить такую операцию бот увидит, что рассылка уже началась для всей аудитории, необработанных клиентов нет, и переведет ее опять в пассивный режим.\n65 Примечание:\nВ зависимости от условий начала рассылки по-разному наступает событие Start. Если аудитория рассылки фиксирована, то событие Start происходит для всех клиентов одновременно в заданное время или сразу после запуска рассылки, или по событию. Если аудитория рассылки не фиксирована, то событие Start происходит при возникновении внешнего события, при выставлении клиенту тега или отправке клиентом ключевого слова боту.\nФиксированная аудитория рассылки задается на вкладке «Целевая аудитория» (см. Рисунок 89). Существует два способа добавления фиксированной аудитории в рассылку: с помощью файлов в формате JSON и CSV.\nРисунок 89 — Вкладка «Целевая аудитория»",  
      "score": 0.5499063682556151,
      "node_ids": [
        "chunk_ch0684",
        "chunk_ch0681",
        "chunk_ch0683",
        "chunk_ch0697",
        "chunk_ch0695",
        "chunk_ch0698",
        "chunk_ch0682",
        "chunk_ch0694",
        "chunk_ch0693",
        "chunk_ch0703",
        "chunk_ch0702",
        "chunk_ch0700",
        "chunk_ch0696",
        "chunk_ch0699",
        "chunk_ch0685"
      ]
    },
    {
      "section_id": "section_ch1055",
      "title": "Использование событий",
      "text": "Использование событий",
      "score": 0.45326742053031915,
      "node_ids": [
        "chunk_ch1055"
      ]
    },
    {
      "section_id": "section_ch1620",
      "title": "Отладка",
      "text": "Отладка\nПри работе с рассылками, которые начинаются при возникновении события, часто необходимо узнать, почему клиент или множество клиентов не получили рассылку. В консоли маркетолога есть специальный раздел «Отладка», который помогает разобраться, что произошло после возникновения определенного события (вкладка «События») или запуска рассылки (вкладка «Рассылки»).\nРисунок 179 — Раздел «Отладка»",
      "score": 0.4306912970542907,
      "node_ids": [
        "chunk_ch1620",
        "chunk_ch1621"
      ]
    },
    {
      "section_id": "section_ch0704",
      "title": "Формат файлов JSON",
      "text": "Формат файлов JSON\nФормат JSON-файла с целевой аудиторией рассылки:\n{\n\"customers\": [\n{\n\"id\": <идентификатор клиента в Maxbot>,\n\"phone\": <телефон>,\n\"messengers_order\": <порядок следования мессенджеров>,\n\"timezone\": <часовой пояс клиента>,\n\"failback_to_sms\": <признак отправки SMS>,\n\"customer_data\": {\n\"<название макроса>\": \"<значение макроса>\"\n}\n}\n],\n\"macroses\": [\n{\n\"name\": <название макроса>,\n\"type\": <тип макроса>\n}\n]\n}\nТаблица 4 — Описание полей JSON-файла описания аудитории рассылки\nПоле Описание Пример использования\ncustomers[] Массив клиентов, описание полей каждого клиента приведено ниже. —\ncustomers[].id Внутренний идентификатор клиента в Maxbot. Получить его можно, скачав в разделе\nВыгрузка аудитории\nфайл с клиентами для выбранного бота. 12345\ncustomers[].phone Телефон клиента в формате \"7xxxxxxxxxx\" без + и 8. \"79999999999\"\ncustomers[].messengers_order Список мессенджеров по приоритету. Возможные значения: telegram, viber, vkontakte, facebook*, Instagram*. [\"telegram\", \"vkontakte\", \"facebook*\"]\ncustomers[].timezone Часовой пояс клиента (см.\nПриложение А\n). \"Europe/Moscow\" \"Etc/GMT+3\" \"Japan\" \"UTC\"\ncustomers[].failback_to_sms Логический признак: отправлять ли SMS клиенту, если он еще не подтвердил номер телефона ни в одном из мессенджеров. Для применения этого признака должен быть задан телефон (phone). Необязательное поле, по умолчанию false. Если failback_to_sms = true и клиент не подтвердил номер телефона, то ему будут отправлены заданные в рассылке SMS. Если failback_to_sms = false, и клиент не подтвердил номер телефона, то клиент не будет добавлен в аудиторию рассылки. Если клиент уже подтвердил указанный номер телефона, то по номеру будет определен id, которому и будет отправлена рассылка в соответствии с заданным приоритетом мессенджеров. Для принудительной отправки SMS клиенту можно задать поле false или true\n67 Поле Описание Пример использования messengers_order пустым и выставить failback_to_sms = True. Тогда клиент получит SMS даже если уже подтвердил номер телефона в мессенджерах.\ncustomers[].customer_data Значения макросов клиента (см. подробнее о макросах в разделе\nИспользование макросов\n), задаются в виде пар значений «имя макроса» : «значение макроса». \"name\": \"Mark\"\nmacroses[] Массив описаний макросов. —\nmacroses[].name Название макроса. \"name\"\nmacroses[].type Тип макроса (см.\nПриложение Б\n). \"string\"\nДля каждого клиента должен быть задан:\n• id\nлибо\n• phone и messengers_order\nлибо\n• только phone (если нужно принудительно отправить SMS).\nЕсли заданы все три поля, то приоритет имеет id.\nПример JSON-файла:\n{\n\"customers\": [\n{\n\"id\": 125241,\n\"timezone\": \"Europe/Moscow\",\n\"customer_data\": {\n\"name\": \"John\"\n}\n},\n{\n\"phone\": \"79999999999\",\n\"messengers_order\": [\"telegram\", \"vkontakte\", \"facebook*\"],\n\"timezone\": \"Europe/Moscow\",\n\"failback_to_sms\": true,\n\"customer_data\": {\n\"name\": \"Mark\"\n}\n}\n],\n\"macroses\": [\n{\n\"name\": \"name\",\n\"type\": \"string\"\n}\n]\n}\nВ указанном примере заданы два получателя рассылки. Первый задается по идентификатору в Maxbot (id), второй — по номеру телефона и приоритету мессенджеров (phone + messengers_order).",
      "score": 0.35200553894042963,
      "node_ids": [
        "chunk_ch0731",
        "chunk_ch0781",
        "chunk_ch0725",
        "chunk_ch0763",
        "chunk_ch0723",
        "chunk_ch0772",
        "chunk_ch0716",
        "chunk_ch0782",
        "chunk_ch0726",
        "chunk_ch0780",
        "chunk_ch0774",
        "chunk_ch0717",
        "chunk_ch0718",
        "chunk_ch0775",
        "chunk_ch0765",
        "chunk_ch0777",
        "chunk_ch0706",
        "chunk_ch0758",
        "chunk_ch0720",
        "chunk_ch0708",
        "chunk_ch0756",
        "chunk_ch0764"
      ]
    },
    {
      "section_id": "section_ch1080",
      "title": "Редактирование событий",
      "text": "Редактирование событий\nПосле создания пользовательского события маркетолог может произвольно редактировать все доступные поля и удалить его.\nЕсли хотя бы одна рассылка настроена на старт по данному событию, то его удаление запрещено, редактирование названия и идентификатора рассылки разрешено. Редактирование и удаление аргументов события ограничено созданными в рассылке макросами. Если аргумент события не используется в рассылке, то его можно удалять и изменять. Если используется, то доступно только изменение названия аргумента.\nЕсли хотя бы одна из рассылок, настроенных на старт по данному событию, запущена, то редактирование всех полей события и его аргументов запрещено.",
      "score": 0.3227043724060058,
      "node_ids": [
        "chunk_ch1080"
      ]
    },
    {
      "section_id": "section_ch1056",
      "title": "Общая информация о событиях",
      "text": "Общая информация о событиях\nСобытия могут являться триггером к началу рассылки для клиента. Это удобно для решения некоторых маркетинговых задач. Например, можно создать событие «Клиент воспользовался услугой» и генерировать его при оплате клиентом услуги. Получив информацию о событии, бот может запустить одну или несколько рассылок этому клиенту: контроль качества через несколько дней, повторное предложение услуги со скидкой через месяц и т. д.\nСобытия делятся на два типа:\n1. Системные:\n• Добавление нового клиента;\n• Подтверждение номера телефона.\n2. Пользовательские.\nСистемные события\nСистемные события генерируются, когда клиент отправляет сообщение боту в первый раз, либо подтверждает номер телефона. Их нельзя удалить или изменить.\nВажно!\nСистемные события срабатывают для всех клиентов, которые подключились к боту или подтвердили номер телефона. При тестировании таких рассылок нужно быть очень\n91 аккуратным и учитывать, что эти события могут происходить одновременно у многих реальных клиентов.\nТестирование таких рассылок лучше производить с использованием отдельного тестового события, и потом только переключать рассылку на начало по системным событиям. Иными словами, аудитория может оказаться шире, чем изначально кажется маркетологу.  И рассылка будет затрагивать всех будущих клиентов, которые подключатся или подтвердят номер телефона. Соответственно, лучше проверить такую рассылку заранее на другом событии и уже потом переключиться на нужное.\nПользовательские события\nПользовательские события могут генерироваться из другой рассылки или с помощью специального вызова API (см. подробнее запросы группы «Генерация событий» в разделе\nAPI консоли маркетолога\n).\nПользовательские события можно создавать и удалять из интерфейса консоли маркетолога (см. Рисунок 123).\nРисунок 123 — Переход к добавлению пользовательского события\nПри создании события задается его идентификатор, имя и аргументы (см. Рисунок 124). Идентификатор события используется при генерации события. Имя используется для отображения события в интерфейсе, например, при выборе события в условиях запуска рассылки.\nРисунок 124 — Ввод аргументов события\nАргументы позволяют передавать дополнительную информацию при генерации события. Например, у системного события «Подтверждение номера телефона» есть аргумент phone_number — номер телефона, который подтвердил клиент.\nПри создании пользовательских событий в них может быть добавлено произвольное число аргументов. Например, для события «Клиент воспользовался услугой» можно добавить аргументы «Дата оказания услуги» и «Мастер, который оказывал услугу». Эти аргументы можно будет использовать в текстах сообщений, кнопках рассылки и других текстовых полях аналогично макросам. Таким образом, можно создавать персонифицированные для каждого клиента рассылки.",
      "score": 0.32225501298904413,
      "node_ids": [
        "chunk_ch1069",
        "chunk_ch1056",
        "chunk_ch1072",
        "chunk_ch1062",
        "chunk_ch1063"
      ]
    },
    {
      "section_id": "section_ch1140",
      "title": "Статусы событий",
      "text": "Статусы событий\nЧасто вызывающей стороне нужно знать, чем закончилась генерация события: началась ли для клиента рассылка; если да, то какая, когда и т. д. Для этого предусмотрены статусы событий, которые можно получить, обработав ответ на запрос генерации событий.\nПри генерации событий в ответе на запрос возвращаются идентификаторы запусков (flow), или идентификаторы отложенных событий.\n100 Если событие сгенерировано по идентификатору клиента или по номеру телефона, и клиент с указанным номером уже существует, то в ответе на запрос генерации события возвращается список launch_customer_ids с идентификаторами запусков рассылок.\nИнформацию по каждому запуску можно получить с помощью API-запроса (см. запрос «Получение статуса запуска рассылки» в разделе\nAPI консоли маркетолога\n).",
      "score": 0.3095294511318206,
      "node_ids": [
        "chunk_ch1140",
        "chunk_ch1146"
      ]
    },
    {
      "section_id": "section_ch1737",
      "title": "Аудит запусков рассылок",
      "text": "Аудит запусков рассылок\nВ некоторых случаях исследование проблем удобнее проводить от рассылки, а не от события. Кроме того, не все рассылки начинаются по событию, некоторые начинаются при выставлении тега или в заданное время. В этом случае удобно использовать вкладку «Рассылки». На данной вкладке можно выполнить поиск информации о запусках рассылок по дате, а также по их характеристикам (для этого нужно нажать на иконку фильтра, см. Рисунок 189).\nРисунок 189 — Поиск рассылок по их характеристикам\nПеречень доступных фильтров и их описание приведены в таблице 11. Для поиска необходимо задать хотя бы один из обязательных фильтров – «Идентификатор», «Название рассылки» или «Дата начала рассылки для клиента».\nТаблица 11 — Описание фильтров для поиска рассылок\nФильтр Описание\nИдентификатор Идентификатор рассылки.\nСостояние рассылки Текущее состояние рассылки.\nИмя клиента Часть или полное имя клиента, для которого началась рассылка.\nМессенджер Мессенджер, через который началась рассылка.\nНомер телефона Номер телефона клиента, для которого началась рассылка.\nСостояние запусков рассылки для клиента См. аналогичное поле ранее в таблице 10.\n146 В результате применения фильтров отображаются записи о запусках рассылок, удовлетворяющие всем заданным условиям. Есть два режима отображения результатов:\n• режим карточек (см. Рисунок 190);\n• режим списка (см. Рисунок 191).\nРежимы отличаются только визуально, переключение между ними выполняется при помощи иконки справа от фильтра.\nРисунок 190 — Вывод информации о найденных рассылках (режим карточек)\nРисунок 191 — Вывод информации о найденных рассылках (режим списка)\nИнформационные поля аналогичны тем, что описаны в подразделе\nАудит вызовов событий\n.\nПри нажатии на ссылку в поле «MID» выполняется переход на страницу с информацией о ходе выполнения рассылки для клиента.\nПри нажатии на ссылку в поле «Состояние» выполняется переход на страницу со статистикой по рассылке (см. подробнее в подразделе\nРабота со статистикой\n).",
      "score": 0.28269374132156366,
      "node_ids": [
        "chunk_ch1744",
        "chunk_ch1746",
        "chunk_ch1761",
        "chunk_ch1743",
        "chunk_ch1757"
      ]
    },
    {
      "section_id": "section_ch1103",
      "title": "События, отложенные до подтверждения клиентом номера телефона",
      "text": "События, отложенные до подтверждения клиентом номера телефона\nПри генерации событий описанным выше запросом рассылка для указанного в ней клиента стартует сразу после получения запроса. Если клиента с таким идентификатором не найдено, то рассылка не будет запущена.\nВ некоторых случаях удобно иметь возможность отложить запуск рассылки для клиентов, которые еще не подключились к боту, и, соответственно, не имеют идентификатора. Например, когда компании выгодно подключать клиентов к боту для ведения дальнейшей коммуникации, и клиентам предлагается скидка, но только в том случае если они подключатся к боту и подтвердят в нем свой номер телефона.\nВ этом случае компания может сгенерировать отложенное событие, указав не идентификатор клиента, а его номер телефона. Бот будет ждать заданное время (ttl, англ. time to live; настройка в интерфейсе называется «Время ожидания подтверждения номера телефона» и задается в секундах, см. Рисунок 130), и если клиент за это время подтвердит свой номер телефона, то событие будет сгенерировано и рассылка для него начнется.\nРисунок 130 — Генерация отложенного события подтверждения номера телефона\nЕсли клиент с таким номером телефона уже есть, то он сразу получит рассылку, несмотря на приоритет мессенджеров (например, если по приоритету Facebook* первый, ВКонтакте второй, а Telegram* третий, но клиент не подтвердил номер в Facebook*, то\n97 рассылка уйдет во ВКонтакте. Среди мессенджеров, где телефон подтвержден, приоритет учитывается).\nПримечание:\nСгенерировать отложенное событие также можно при помощи\nAPI-вызова\n, задав ненулевой параметр ttl (см. запрос «Генерация события по номеру телефона» в разделе\nAPI консоли маркетолога\n).",
      "score": 0.26899936556816095,
      "node_ids": [
        "chunk_ch1115"
      ]
    },
    {
      "section_id": "section_ch1130",
      "title": "Отправка рассылок по номеру телефона",
      "text": "Отправка рассылок по номеру телефона\nВ некоторых случаях неудобно генерировать событие указывая идентификатор клиента. Для таких случаев можно указать номер телефона, время ожидания подтверждения номера телефона = 0 и приоритет мессенджеров.\nВ этом случае бот запустит рассылку, настроенную на начало по указанному событию, для клиента с указанным номером телефона. Если клиент подтвердил свой номер в нескольких мессенджерах, то будет взят первый по заданному приоритету. Если нет клиентов, которые подтвердили указанный номер телефона, то рассылка не начнется ни для кого из клиентов.\nРисунок 133 — Отправка рассылки по номеру телефона с указанием приоритета мессенджеров\nОтправка рассылок по номеру телефона и отложенные события отличаются только параметром «Время ожидания подтверждения номера телефона». Внутренний механизм и запрос API-запрос одинаковы (см. запрос «Генерация события по номеру телефона» в разделе\nAPI консоли маркетолога\n).\nПримечание:\nПри отправке SMS-рассылок флажок «Отправлять SMS если мессенджеры не используются или клиент не подключен к ним» должен быть установлен, поле «Время ожидания подтверждения номера телефона» должно быть установлено в 0, рассылка должна содержать SMS-блок.",
      "score": 0.26899936556816095,
      "node_ids": [
        "chunk_ch1137"
      ]
    },
    {
      "section_id": "section_ch1085",
      "title": "Тестирование рассылок, запускаемых по событию",
      "text": "Тестирование рассылок, запускаемых по событию\nВ интерфейсе консоли маркетолога предусмотрена возможность генерации событий в целях тестирования.\nДля этого можно нажать кнопку «Сгенерировать событие» в разделе «События» напротив выбранного события (см. Рисунок 125) или на странице самого события (см. Рисунок 126).\nРисунок 125 — Кнопки генерации событий в списке\nРисунок 126 — Кнопка генерации события на странице события\n94 После генерации события с использованием интерфейса Marketer в области «Список launch_result_ids» отображаются специальные ссылки (см. Рисунок 127), позволяющие перейти к отладке рассылки.\nРисунок 127 — Сгенерировано событие с идентификатором запуска (launch_result_id)\nПри переходе по ссылке отображается интерфейс отладки (см. подробнее раздел\nОтладка\n), в котором применен фильтр по выбранному идентификатору запуска (launch_result_id), см. Рисунок 128.\nРисунок 128 — Просмотр результатов генерации события в разделе «Отладка»\n95 Для передачи информации о запросе разработчикам компании, например, для интеграции с CRM, удобно использовать кнопки копирования запроса в формате curl (см. Рисунок 129).\nРисунок 129 — Кнопки для копирования запроса в формате curl\nПри генерации событий при помощи интерфейса консоли маркетолога система не даст ввести значения аргументов, не соответствующие их типу. При генерации событий при помощи API-вызовов также выполняется проверка соответствия типов аргументов. Например, при вызове события с некорректным значением аргумента vip:\ncurl -X POST -H \"Content-Type: application/json\" -H \"Authorization: Bearer Contoso_:eyJoXfD saJkKrsGFH...\" -d '{ \"customer_messenger_id\": 13561, \"event_name\": \"numeric_code_for_client\", \"arguments\": { \"code\": 133442, \"discount\": 15, \"vip\": \"no\" } }' \"https://mailing-factory.dev.maxbot.ai/v1/event\"\nсервер вернет ответ с HTTP-статусом 409:\nHTTP/2 409 { \"detail\": \"Argument type error(boolean): no\", \"key\": \"argument_type\", }",
      "score": 0.2456912970542907,
      "node_ids": [
        "chunk_ch1093"
      ]
    },
    {
      "section_id": "section_ch1624",
      "title": "Аудит вызовов событий",
      "text": "Аудит вызовов событий\nНа вкладке «События» можно найти информацию о попытках сгенерировать то или иное событие. Поиск возможен по дате события, а также по его характеристикам. (для этого нужно нажать на иконку фильтра, см. Рисунок 180):\nРисунок 180 — Поиск события по его характеристикам\nПеречень доступных фильтров и их описание приведены в таблице 10. Между собой фильтры применяются по условию «И», т. е. возвращаются результаты, удовлетворяющие всем фильтрам.\nТаблица 10 — Описание фильтров для поиска событий\nФильтр Описание\nДата Дата попытки сгенерировать событие. Единственный обязательный фильтр для выполнения поиска.\nНазвание события В этом фильтре может быть указано полное название события или его часть (выполняется поиск заданной подстроки в названии события).\nСписок идентификаторов рассылок Идентификаторы рассылок, которые начаты в результате вызова события. Фильтр применяется по условию «ИЛИ», т. е. возвращаются результаты, удовлетворяющие хотя бы одному из заданных значений.\nСписок launch_result_ids Идентификаторы запусков (launch_customer_ids или sms_launch_customer_ids или delayed_trigger_event_id, или unsubscribed_trigger_event_id), полученные в результате генерирования событий. Фильтр применяется по условию «ИЛИ», т. е. возвращаются результаты, удовлетворяющие хотя бы одному из заданных значений.\nИдентификатор бота В этом фильтре может быть указано полное системное название бота или его часть, т. е. выполняется поиск заданной подстроки.\nИдентификатор клиента Идентификатор клиента, для которого началась рассылка в результате возникновения события.\nИмя клиента Имя клиента, для которого началась рассылка в результате возникновения события.\nНомер телефона Полный номер телефона клиента или его часть, для которого началась рассылка в результате возникновения события. Т.е. выполняется поиск заданной подстроки\nТипы запуска рассылки по событию Позволяет отфильтровать события по «последствиям» запуска. Можно задать одно или несколько значений из:\n• «Ожидание подтверждения телефона» – события, в результате вызова которых началось ожидание подтверждения клиентом номера телефона (случай, когда в результате вызова события возвращается delayed_trigger_event_id).\n• «Ожидание подписки на бота в мессенджере» – события, в результате вызова которых началось ожидание подписки клиента на бота в мессенджере (случай, когда в результате вызова события возвращается unsubscribed_trigger_event_id).\n• «Передано в транспорт мессенджера» – события, в результате вызова которых началось отправка рассылки в мессенджер (случай, когда в результате вызова события возвращается launch_customer_ids).\n138 Фильтр Описание\n• «Передано в SMS-провайдер» – события, в результате вызова которых началось отправка SMS-рассылки (через SMS-провайдер, случай, когда в результате вызова события возвращается sms_launch_customer_ids).\nРезультат вызова события Статус-код запроса вызова события:\n• 200 — запрос выполнен успешно;\n• 40X – различные виды ошибок.\nСписок возможных источников события Один или несколько источников, откуда сгенерировано событие:\n• Рассылка – события, сгенерированные из сценария рассылки (действие «Сгенерировать событие» в конструкторе рассылок);\n• Интерфейс – события, сгенерированные из консоли маркетолога;\n• API – события, сгенерированные путем вызова одного из запросов API;\n• Системное событие – системные события, сгенерированные ботом (в текущей версии Maxbot это «Подтверждение номера телефона» и «Добавление нового клиента»).\nСостояние запусков рассылки для клиента Статус запуска рассылки для клиента:\n• «Готов к отправке» — рассылка готова к началу, но еще не началась;\n• «Рассылка началась успешно»;\n• «Ошибка при запуске рассылки»;\n• «Пропущен, в рассылке нет SMS-блока» — сгенерировано событие для отправки SMS, но в рассылке нет SMS-блока;\n• «Пропущен, входит в аудиторию другой рассылки»;\n• «Клиент отписался от рассылок»;\n• «Клиент не оплачен»;\n• «Клиент уже получал рассылку»;\n• «Рассылка не успела начаться» – рассылка не началась, т. к. ее остановили, не успев начать ее для клиента;\n• «Ошибка при запуске SMS-рассылки»;\n139 Фильтр Описание\n• «Ошибка при вызове внешней системы в SMS-блоке»;\n• «Ошибка при генерации диплинка для SMS-блока» — при отправке SMS-рассылки с лендингом при генерации диплинка возникла ошибка;\n• «Телефон подтвержден до попытки отправить SMS» — клиент подтвердил номер телефона до отправки SMS, отправка будет осуществлена через мессенджер;\n• «Ожидает подписки клиента в мессенджере» — начало рассылки отложено до подписки клиентом на бота в мессенджере;\n• «Ожидает подтверждения номера телефона» — начало рассылки отложено до подтверждения клиентом номера телефона.\nВ результате применения фильтров отображаются записи о попытках сгенерировать события, удовлетворяющие всем заданным условиям.\nЕсть два режима отображения результатов:\n• режим карточек (см. Рисунок 181);\n• режим списка (см. Рисунок 182).\nРисунок 181 — Просмотр найденных событий (режим карточек)\nРисунок 182 — Просмотр найденных событий (режим списка)\nРежимы отличаются только визуально, переключение между ними выполняется при помощи иконки справа от фильтра.\nПри нажатии на ссылку в поле «ID» можно перейти на страницу с детальной информацией о сгенерированном событии. Эта страница разделяется на две части. В верхней части страницы отображается общая информация о сгенерированном событии (см. Рисунок 183):\n• ID — идентификатор записи о генерации события в журнале аудита событий;\n• Источник — источник, откуда пришел запрос на генерацию события. См. «Список возможных источников события» выше;\n• Рассылка — название рассылки, если событие было сгенерировано из сценария рассылки;\n• Дата — дата генерации события;\n• Название события из запроса — название события, как оно было указано в запросе;\n• ID события — идентификатор события в системе;\n• ID клиента — идентификатор клиента, для которого было сгенерировано событие;\n• Мессенджер — мессенджер клиента, для которого было сгенерировано событие;\n• Телефон — телефон клиента, для которого было сгенерировано событие;\n• Тип — тип запроса на генерацию события. Возможные варианты:\n• По идентификатору клиента;\n• По номеру телефона;\n• Для рассылок с фиксированной аудиторией;\n• Запрос — тело запроса на генерацию события. Для просмотра и копирования нужно навести мышью на «глазок»;\n• Статус-код — HTTP status code ответа на запрос генерации события;\n• Ответ — тело ответа на запрос генерации события. Для просмотра и копирования нужно навести мышью на «глазок».\nРисунок 183 — Общая информация о сгенерированном событии\nВ нижней части страницы отображается информация о рассылках, начавшихся в результате возникновения события, либо информация о начавшемся ожидании подтверждения номера телефона или подписки клиента в мессенджере. Информация на странице с деталями события позволяет понять, началась ли рассылка при вызове события, а также ответить на вопросы – если рассылка началась, то какая, и если не началась, то почему. Далее в подразделах приведены примеры вывода такой информации.\nРассылка в мессенджер (одна или несколько) началась сразу после возникновения события\nСведения о начавшихся рассылках в мессенджере содержат (см. Рисунок 184):\n• ID — идентификатор записи о генерации события в журнале аудита событий;\n• Дата — дата генерации события;\n• MID — идентификатор начавшейся рассылки. При нажатии на ссылку можно перейти на страницу с информацией о ходе выполнения рассылки для этого клиента. Подробнее это описано в разделе\nПросмотр хода выполнения рассылок\n;\n• Рассылка — название рассылки, которая началась в результате вызова события. При клике по ссылке можно перейти на страницу редактирования рассылки;\n• Launch — идентификатор запуска рассылки, получаемый при генерации события (в поле launch_customer_ids ответа на запрос генерации события);\n• Запуск, Остановка — даты запуска и остановки рассылки соответственно (в текущей версии Maxbot) не заполняется;\n• Состояние — текущее состояние рассылки;\n• CID — идентификатор клиента, для которого началась рассылка;\n• Статус — состояние запуска рассылки для клиента, см. ранее описание фильтра «Состояние запусков рассылки для клиента»;\n• Попыток — количество попыток начать рассылку;\n• Последняя попытка — дата последней попытки начать рассылку для клиента.\n• Аргументы — аргументы события, переданные при генерации. Для просмотра и копирования нужно навести мышью на «глазок».\nРисунок 184 — Пример вывода информации о рассылках в мессенджер, которые начались сразу после возникновения события\nSMS-рассылка (одна или несколько) началась сразу после возникновения события\nСведения о начавшихся SMS-рассылках практически аналогичны варианту с рассылкой в мессенджер. Дополнительно для SMS-рассылок отображаются следующие данные (см. Рисунок 185):\n• Телефон — телефон, для которого сгенерировано событие;\n• Мессенджеры — список messenger_order, как он был указан при вызове события;\n• Временная зона — значение поля timezone, указанное при вызове события.\nРисунок 185 — Пример вывода информации о SMS-рассылке, которая началась сразу после возникновения события\nЕсли сообщения не приходят, то разобраться в причине можно, изучив ответ от SMS- провайдера. Для этого необходимо нажать на иконку в поле «Ошибка» (если ошибка имеет место), см. рисунок 186:\nРисунок 186 — Просмотр информации об ошибке при отправке SMS-рассылок\nВызов события отложен до подтверждения номера телефона\nСведения о событиях, отложенных до подтверждения номера телефона, практически аналогичны вариантам, описанным ранее. Дополнительно отображаются следующие данные (см. Рисунок 187):\n• TTL — таймаут ожидания подтверждения номера телефона, заданный при вызове события;\n• Истечение — дата, когда истекло ожидание.\nРисунок 187 — Пример вывода информации о событии, отложенном до подтверждения номера телефона\nВызов события отложен до подписки на бота в мессенджере\nСведения о событиях, отложенных до подписки на бота в мессенджера, практически аналогичны вариантам, описанным ранее. Дополнительно отображаются следующие данные (см. Рисунок 188):\n• TTL — таймаут ожидания подписки на бота в мессенджере, заданный при вызове события;\n• Истечение — дата, когда истекло ожидание подписки.\nРисунок 188 — Пример вывода информации о событии, отложенном до подписки на бота в мессенджере",
      "score": 0.23260688543319696,
      "node_ids": [
        "chunk_ch1704"
      ]
    },
    {
      "section_id": "section_ch1762",
      "title": "Просмотр хода выполнения рассылок",
      "text": "Просмотр хода выполнения рассылок\nВ некоторых случаях нужно знать не только когда рассылка началась и для каких клиентов, но и знать, как она выполнялась для конкретного пользователя — что делал клиент (какие нажимал кнопки, что писал) и что ему отвечал бот в рамках рассылок.\n147 Для этого предназначена специальная страница — «Ход исполнения рассылок». Попасть на нее можно из раздела «Отладка» по ссылкам из полей «MID» в результатах поиска. Информация на данной странице делится на два блока. Верхний блок — общая информация о рассылке, клиенте и запусках этой рассылки для этого клиента (см. Рисунок 192).\nПомимо сведений о рассылке и о клиенте здесь отображаются два признака:\n• «Разрешена отправка сообщений» — признак свидетельствует о текущем состоянии подписки клиента на бота в мессенджере. Если флажок установлен, то клиент подписан, если снята — отписан. Не следует путать это с подпиской/отпиской на рассылки.\n• «Пользователь добавлен в таблицу\n″\nОплаченных пользователей\n″\n» - признак свидетельствует о том, оплачено ли обслуживание этого клиента или нет в соответствии с текущим тарифом.\nРисунок 192 — Общая информация о рассылке\nЕсли SMS не приходят, то разобраться можно, изучив ответ от SMS-провайдера. Для этого необходимо нажать на иконку в поле «Ошибка» (если ошибка имеет место), см. рисунок 193:\nРисунок 193 — Информация об ошибке при запуске SMS-рассылки\nНижний блок содержит описание хода выполнения всех запусков рассылки для этого клиента (см. Рисунок 194).\nСлева выводятся возникающие события — начало рассылки, реакция клиента (например, нажатие на кнопку), события от планировщика для отправки сообщений с заданным таймаутом и т. д.\nСправа выводится действия бота — реакция на возникающие события. Здесь же выводятся некоторые пояснения по ходу выполнения рассылки. Например, «От события \"старт\" ждем 120 секунд и закрытия треда, а затем переходим в блок \"Блок\"» или «Обработка нажатий на кнопки выключена». Нажатие на ссылки «response» или «event» позволяет раскрыть детали события или действия.\nРисунок 194 — Ход выполнения рассылки для клиента\nИнформация в этом блоке позволяет восстановить ход выполнения рассылки для конкретного клиента и понять причины той или иной реакции бота.\nВ случае SMS-рассылок страница выглядит несколько иначе (см. Рисунок 195). На ней отображается только общая информация о рассылке, клиенте и ее запусках для этого\n149 клиента. Нижней части с информацией о ходе выполнения рассылки нет, т. к. SMS- рассылки не подразумевают реакцию клиента.\nРисунок 195 — Ход выполнения SMS-рассылки",
      "score": 0.22325649619102472,
      "node_ids": [
        "chunk_ch1768",
        "chunk_ch1770"
      ]
    },
    {
      "section_id": "section_ch1116",
      "title": "События, отложенные до подписки клиента в мессенджере",
      "text": "События, отложенные до подписки клиента в мессенджере\nКлиенты всех поддерживаемых мессенджеров имеют возможность отписаться от получения сообщений от бота в мессенджере (не следует путать с отпиской от всех рассылок на уровне Maxbot). Это приводит к невозможности отправлять таким клиентам какие-либо сообщения.\nВ некоторых случаях может быть целесообразно подождать, пока клиент подпишется обратно. Например, когда клиенту предлагают присылать информацию о статусе сделанного заказа.\nДля этого предназначен второй тип ожидания — ожидание подписки клиента в мессенджерах; это время также задается в секундах (см. Рисунок 131).\nРисунок 131 — Генерация отложенного события ожидания подписки в мессенджере\nПримечание:\nДанный тип ожидания может быть задан как в запросе генерации отложенного события, так и в запросе генерации обычного события по идентификатору клиента. Для указания задержки используется параметр запроса unsubscribed_ttl (настройка в интерфейсе —\n98 «Время ожидания подписки в мессенджере»). Подробнее об этом см. в описании API- запросов группы «Генерация событий» в разделе\nAPI консоли маркетолога\n.\nРисунок 132 — Генерация отложенного события ожидания подписки в мессенджере (по идентификатору клиента)\nЕсли клиент подписывается в мессенджере в течение указанного времени, то для него начинается рассылка. Если не успевает, то рассылка не начинается, событие считается просроченным.\nПримечание:\nКлиенту можно отправить SMS если он отписался от бота в мессенджере. Для этого нужно выставить флаг failback_to_sms (в интерфейсе флажок «Отправлять SMS, если мессенджеры не используются или клиент не подключен к ним») и задать параметр unsubscribed_ttl=0 (в интерфейсе в поле «Время ожидания подписки в мессенджере» задать 0). Если при этом задать параметр unsubscribed_ttl > 0, то бот начнет ожидание подписки в мессенджере, SMS рассылка не начнется.",
      "score": 0.22041663289070124,
      "node_ids": [
        "chunk_ch1125"
      ]
    }
  ]
}