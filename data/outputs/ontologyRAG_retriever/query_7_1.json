{
  "query": "макросы в конструкторе рассылок",
  "focus_summary": "Нужно протестировать функциональность использования макросов в конструкторе рассылок: их создание, типы, применение в различных полях сообщений и действий, а также проверки корректности задания значений для клиентов. Особое внимание — персонализация рассылок и валидация макросов при запуске.",
  "core_passages": [
    {
      "section_id": "section_ch1147",
      "title": "Использование макросов",
      "role": "core",
      "importance": "high",
      "summary": "Макросы позволяют персонифицировать рассылки для клиентов, подставляя уникальные значения из файла аудитории или аргументов события. Примеры макросов: customer_name и customer_discount. Значения задаются в JSON-файле аудитории, где для каждого клиента указываются данные. После запуска клиенты получают персонализированные сообщения с подстановкой значений."
    },
    {
      "section_id": "section_ch2133",
      "title": "Приложение Б. Типы макросов",
      "role": "core",
      "importance": "high",
      "summary": "Макросы могут иметь типы: date, decimal, categorical, boolean, string. Для строковых макросов можно использовать символ \\n для разделения строк, но эта возможность доступна только через API; при тестовом вызове из интерфейса клиент получит \\n в тексте как есть."
    },
    {
      "section_id": "section_ch1188",
      "title": "Поля, в которых можно использовать макросы",
      "role": "core",
      "importance": "high",
      "summary": "Макросы можно использовать почти во всех текстовых полях конструктора рассылок: тексты сообщений, заголовки кнопок, URL для кнопок-ссылок и медиа-контента, сообщения при переводе в канал, большинство полей настроек вызова внешней системы, аргументы события при генерации событий, текстовые поля SMS-блока и другие. Возможности использования описываются отдельно для каждого действия."
    },
    {
      "section_id": "section_ch1208",
      "title": "Проверка наличия макросов",
      "role": "core",
      "importance": "high",
      "summary": "Система проверяет наличие макросов, чтобы не допустить запуск рассылки с незаданными значениями. Правила: для статической аудитории макросы должны быть у всех клиентов; для событийных рассылок можно использовать только макросы, совпадающие с аргументами события; для рассылок по тегам или ключевым словам макросы недопустимы; для фиксированной аудитории с событием макросы из аудитории и события не могут пересекаться."
    }
  ],
  "supporting_passages": [
    {
      "section_id": "section_ch1247",
      "title": "Использование макросов в настройках вызова внешней системы и в действии генерации события",
      "role": "supporting",
      "importance": "medium",
      "summary": "В настройках вызова внешней системы макросы в полях адреса, текста ошибки и значения заголовка задаются в двойных фигурных скобках. В полях значения параметра запроса, тела запроса и аргументов событий макросы задаются как jinja-выражения с приставкой 'slots.m.' без скобок. Приведены примеры заполнения."
    },
    {
      "section_id": "section_ch1204",
      "title": "Создание и удаление макросов рассылки",
      "role": "supporting",
      "importance": "medium",
      "summary": "Макросы создаются неявно при упоминании в текстовых полях рассылки и состоят из латинских букв, цифр, подчеркивания в двойных фигурных скобках. Удаляются, если убрать из всех полей. Пример: написание '{{ abc }}' создает макрос abc."
    },
    {
      "section_id": "section_ch1217",
      "title": "Определение значений макросов для клиентов",
      "role": "supporting",
      "importance": "medium",
      "summary": "Для рассылок со статической аудиторией значения макросов задаются в JSON или CSV-файлах аудитории. Для рассылок по событию значения передаются в аргументах события, которые становятся макросами в рассылке. Пример: событие 'Создание промокода для клиента' с аргументами code, discount, valid_thru."
    },
    {
      "section_id": "section_ch0125",
      "title": "Блоки действий",
      "role": "supporting",
      "importance": "low",
      "summary": "Блок может содержать действия: отправка сообщения, перевод в канал, вызов внешней системы и другие. В тексте сообщений, URL медиа-контента, кнопках и других полях можно использовать макросы. Описаны особенности использования макросов в медиа группах, кнопках-действиях и конфиденциальных данных. Упомянуты ограничения, например, максимальное количество элементов в медиа группе — 50."
    }
  ],
  "discarded_sections": [
    "section_ch0113",
    "section_ch0434"
  ],
  "domain_entities": [
    "Макрос",
    "Расслыка",
    "Клиент",
    "Аудитория",
    "Событие",
    "Аргумент события",
    "Блок действий",
    "Медиа группа",
    "Кнопка-действие",
    "Кнопка-ссылка",
    "Внешняя система"
  ],
  "hints_for_tests": [
    "Проверить создание макросов через упоминание в текстовых полях и автоматическое удаление при очистке.",
    "Протестировать подстановку значений макросов разных типов (string, decimal, date и др.) в сообщениях и полях.",
    "Убедиться, что макросы корректно работают в URL медиа-контента, кнопках, настройках внешних систем и аргументах событий.",
    "Проверить валидацию макросов: ошибки при отсутствии значений у клиентов, несовпадении с аргументами события, запрете для рассылок по тегам.",
    "Тестировать персонализацию: разные значения макросов для разных клиентов в одной рассылке.",
    "Проверить обработку строковых макросов с символом \\n: корректность через API и отображение в интерфейсе.",
    "Убедиться, что макросы из аудитории и события не пересекаются в рассылках с фиксированной аудиторией и событием."
  ]
}