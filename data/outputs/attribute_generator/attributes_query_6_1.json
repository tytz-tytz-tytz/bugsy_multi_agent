[
  {
    "id": "EVT-001",
    "name": "Условная отправка вопроса при выполнении условия",
    "type": "functional",
    "priority": "P1",
    "description": "Условный вопрос в форме должен отправляться клиенту только в том случае, если выполнено заданное условие, например, равенство или неравенство значения ответа на предыдущий вопрос.",
    "positive_example": "Если условие отправки вопроса B — 'ответ на вопрос A равен 5', и клиент ответил на вопрос A значением 5, то вопрос B отправляется клиенту.",
    "negative_example": "Если условие отправки вопроса B — 'ответ на вопрос A равен 5', а клиент ответил на вопрос A значением 3, то вопрос B не отправляется.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Условный вопрос отправляется только при выполнении определенного условия, например, если клиент поставил низкую оценку."
    ]
  },
  {
    "id": "EVT-002",
    "name": "Порядок следования условного вопроса",
    "type": "business_rule",
    "priority": "P1",
    "description": "Условный вопрос должен располагаться в списке вопросов формы строго после вопроса, ответ на который проверяется в условии его отправки.",
    "positive_example": "Вопрос B с условием, проверяющим ответ на вопрос A, расположен в форме после вопроса A.",
    "negative_example": "Вопрос B с условием, проверяющим ответ на вопрос A, расположен в форме до вопроса A или на той же позиции.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Условный вопрос должен располагаться в списке после вопроса, ответ на который проверяется."
    ]
  },
  {
    "id": "EVT-003",
    "name": "Обработка пропущенного вопроса в условии 'Не равно'",
    "type": "functional",
    "priority": "P2",
    "description": "Если вопрос, ответ на который проверяется в условии отправки условного вопроса, был пропущен клиентом (не получен ответ), то все условия типа 'Не равно' для этого вопроса должны срабатывать, независимо от значения сравнения.",
    "positive_example": "Условие отправки вопроса B — 'ответ на вопрос A не равен 5'. Клиент пропустил вопрос A. Вопрос B отправляется клиенту.",
    "negative_example": "Условие отправки вопроса B — 'ответ на вопрос A не равен 5'. Клиент пропустил вопрос A. Вопрос B не отправляется.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Если вопрос, ответ на который проверяется, был пропущен клиентом, то срабатывают все условия 'Не равно' при любом значении сравнения."
    ]
  },
  {
    "id": "EVT-004",
    "name": "Использование ответов в Jinja-шаблонах",
    "type": "functional",
    "priority": "P1",
    "description": "Ответы на вопросы формы должны корректно подставляться в Jinja-шаблоны с использованием синтаксиса {{ form.<идентификатор_ответа> }}.",
    "positive_example": "В шаблоне рассылки указано {{ form.rating }}, и при отправке подставляется значение ответа на вопрос с идентификатором 'rating'.",
    "negative_example": "В шаблоне указано {{ form.rating }}, но значение не подставляется или подставляется некорректно (например, пустое или ошибка).",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "В jinja-шаблонах указывается {{ form.<идентификатор_ответа> }}"
    ]
  },
  {
    "id": "EVT-005",
    "name": "Использование ответов в Jinja-выражениях",
    "type": "functional",
    "priority": "P1",
    "description": "Ответы на вопросы формы должны корректно подставляться в Jinja-выражения с использованием синтаксиса slots.<идентификатор_ответа>.",
    "positive_example": "В выражении для условной логики используется slots.rating, и оно корректно вычисляется на основе значения ответа.",
    "negative_example": "Выражение slots.rating возвращает ошибку или некорректное значение.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "в jinja-выражениях - slots.<идентификатор_ответа>"
    ]
  },
  {
    "id": "EVT-006",
    "name": "Обработка ответов при выходе из формы по таймауту или желанию клиента",
    "type": "functional",
    "priority": "P2",
    "description": "При выходе из формы по таймауту или по желанию клиента, в данных должны присутствовать ответы только на отвеченные вопросы; для неотвеченных вопросов значение должно быть None.",
    "positive_example": "Клиент ответил на вопрос A и вышел из формы. В переданных данных есть ответ на вопрос A, а для вопроса B значение None.",
    "negative_example": "При выходе по таймауту для неотвеченного вопроса передано значение, отличное от None (например, пустая строка или дефолтное значение).",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "При выходе по таймауту или по желанию клиента ответы будут только на отвеченные вопросы, на остальные - None."
    ]
  },
  {
    "id": "EVT-007",
    "name": "Формат ответа для типа вопроса 'Файл'",
    "type": "functional",
    "priority": "P2",
    "description": "Для вопроса типа 'Файл' ответ должен представлять собой список URL загруженных файлов.",
    "positive_example": "Клиент загрузил два файла, ответ — ['https://example.com/file1.jpg', 'https://example.com/file2.pdf'].",
    "negative_example": "Ответ на вопрос типа 'Файл' представлен как одиночная строка URL или другой формат данных.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "Для типа вопроса 'Файл' ответ - список URL"
    ]
  },
  {
    "id": "EVT-008",
    "name": "Преобразование ответа 'Файл' в строку для передачи",
    "type": "functional",
    "priority": "P3",
    "description": "При необходимости передачи ответа на вопрос типа 'Файл' в виде строки (например, во внешние системы), должно поддерживаться преобразование списка URL в строку с использованием Jinja-фильтров, таких как |list|join(', ').",
    "positive_example": "В шаблоне используется {{ form.file_uploads|list|join(', ') }}, что преобразует список URL в строку, разделенную запятыми.",
    "negative_example": "Попытка использовать ответ 'Файл' напрямую в контексте, требующем строку, без преобразования приводит к ошибке или некорректному отображению.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "для передачи в некоторых случаях требуется преобразование списка в строку с помощью фильтров (например, |list|join(', '))"
    ]
  },
  {
    "id": "EVT-009",
    "name": "Проверка пустоты ответа 'Файл'",
    "type": "functional",
    "priority": "P3",
    "description": "Должна быть возможность проверить, является ли ответ на вопрос типа 'Файл' пустым (например, клиент не загрузил файлы), используя соответствующую проверку в Jinja-выражениях или условиях.",
    "positive_example": "Условие 'если slots.file_uploads пусто' корректно определяет отсутствие загруженных файлов.",
    "negative_example": "Проверка на пустоту для ответа 'Файл' всегда возвращает false, даже если список URL пуст.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "и проверка на пустоту"
    ]
  },
  {
    "id": "EVT-010",
    "name": "Передача ответов во внешние системы при выходе из формы",
    "type": "functional",
    "priority": "P1",
    "description": "Ответы на вопросы формы должны передаваться во внешние системы при любом выходе из формы (завершение, таймаут, выход по желанию клиента).",
    "positive_example": "При выходе клиента из формы, все ответы (или None для неотвеченных) корректно отправляются в указанную внешнюю систему через webhook или API.",
    "negative_example": "Ответы не передаются во внешнюю систему при выходе по таймауту или передаются неполные данные.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "Ответы можно передавать во внешние системы при выходе из формы."
    ]
  }
]