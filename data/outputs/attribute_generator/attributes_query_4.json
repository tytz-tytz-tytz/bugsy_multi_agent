[
  {
    "id": "AUD-001",
    "name": "Фиксированная аудитория неизменна после старта",
    "type": "business_rule",
    "priority": "P1",
    "description": "Фиксированная аудитория рассылки задается до запуска и не может быть изменена после старта рассылки.",
    "positive_example": "Рассылка запущена с фиксированной аудиторией из 100 клиентов. После старта попытка добавить еще одного клиента в эту аудиторию отклоняется системой.",
    "negative_example": "После запуска рассылки с фиксированной аудиторией система позволяет добавить новых клиентов в список получателей.",
    "source_section_ids": [
      "section_ch0681"
    ],
    "source_quotes": [
      "Фиксированная аудитория задается до запуска и не может быть изменена после старта"
    ]
  },
  {
    "id": "AUD-002",
    "name": "Фиксированная аудитория допускает только один запуск",
    "type": "business_rule",
    "priority": "P1",
    "description": "Для рассылки с фиксированной аудиторией возможен только один запуск.",
    "positive_example": "Рассылка с фиксированной аудиторией запущена один раз. Повторный запуск той же рассылки невозможен.",
    "negative_example": "Рассылка с фиксированной аудиторией успешно запускается несколько раз подряд.",
    "source_section_ids": [
      "section_ch0681"
    ],
    "source_quotes": [
      "для нее возможен только один запуск"
    ]
  },
  {
    "id": "AUD-003",
    "name": "Динамическая аудитория не имеет ограничений",
    "type": "business_rule",
    "priority": "P2",
    "description": "Динамическая аудитория формируется в ходе рассылки по событиям, тегам или ключевым словам и не может быть ограничена.",
    "positive_example": "Рассылка с динамической аудиторией по событию 'покупка' включает всех клиентов, совершивших покупку после старта рассылки, без ограничения количества.",
    "negative_example": "Система отказывается добавлять в динамическую аудиторию клиентов сверх установленного лимита в 1000 человек.",
    "source_section_ids": [
      "section_ch0681"
    ],
    "source_quotes": [
      "Динамическая аудитория формируется в ходе рассылки по событиям, тегам или ключевым словам и не может быть ограничена"
    ]
  },
  {
    "id": "AUD-004",
    "name": "Приоритет полей клиента в JSON",
    "type": "functional",
    "priority": "P1",
    "description": "При задании аудитории через JSON-файл, если для клиента указаны все поля (id, phone, messengers_order), приоритет имеет id.",
    "positive_example": "В JSON-файле для клиента указаны id=123, phone=+79001234567, messengers_order=['whatsapp']. Система использует id=123 для идентификации клиента, игнорируя phone и messengers_order.",
    "negative_example": "При наличии всех трех полей система пытается использовать phone и messengers_order, а id игнорируется.",
    "source_section_ids": [
      "section_ch0704"
    ],
    "source_quotes": [
      "Приоритет имеет id, если заданы все поля"
    ]
  },
  {
    "id": "AUD-005",
    "name": "Обязательные поля для клиента в JSON",
    "type": "functional",
    "priority": "P1",
    "description": "Для клиента в JSON-файле аудитории должен быть задан либо id, либо phone и messengers_order, либо только phone (для принудительной отправки SMS).",
    "positive_example": "Клиент задан как { \"phone\": \"+79001234567\", \"messengers_order\": [\"telegram\"] } — корректно. Или { \"phone\": \"+79001234567\" } — для принудительной SMS.",
    "negative_example": "Клиент задан как { \"messengers_order\": [\"whatsapp\"] } без phone или id — система возвращает ошибку валидации.",
    "source_section_ids": [
      "section_ch0704"
    ],
    "source_quotes": [
      "Для клиента должен быть задан либо id, либо phone и messengers_order, либо только phone (для принудительной отправки SMS)"
    ]
  },
  {
    "id": "EVT-001",
    "name": "Системные события неизменяемы",
    "type": "business_rule",
    "priority": "P1",
    "description": "Системные события (например, добавление клиента, подтверждение номера) нельзя изменить или удалить.",
    "positive_example": "Попытка через API изменить название системного события 'client_added' возвращает ошибку с кодом 403 (Forbidden).",
    "negative_example": "Интерфейс позволяет редактировать аргументы или удалить системное событие 'phone_confirmed'.",
    "source_section_ids": [
      "section_ch1056"
    ],
    "source_quotes": [
      "Системные события нельзя изменить или удалить"
    ]
  },
  {
    "id": "EVT-002",
    "name": "Системные события срабатывают для всех клиентов",
    "type": "business_rule",
    "priority": "P2",
    "description": "Системные события срабатывают для всех клиентов в системе.",
    "positive_example": "При добавлении нового клиента в систему событие 'client_added' генерируется и может запустить рассылку для всех существующих клиентов, если она на него настроена.",
    "negative_example": "Системное событие 'phone_confirmed' срабатывает только для клиентов определенной группы, игнорируя остальных.",
    "source_section_ids": [
      "section_ch1056"
    ],
    "source_quotes": [
      "Системные события ... срабатывают для всех клиентов"
    ]
  },
  {
    "id": "EVT-003",
    "name": "Запрет удаления события, используемого в рассылке",
    "type": "business_rule",
    "priority": "P1",
    "description": "Если пользовательское событие используется в рассылке, его удаление запрещено.",
    "positive_example": "Событие 'purchase_completed' используется в активной рассылке. Попытка удалить это событие через интерфейс блокируется с сообщением об ошибке.",
    "negative_example": "Событие, на которое ссылается рассылка, успешно удаляется, что приводит к ошибке при запуске рассылки.",
    "source_section_ids": [
      "section_ch1080"
    ],
    "source_quotes": [
      "Если событие используется в рассылке, удаление запрещено"
    ]
  },
  {
    "id": "EVT-004",
    "name": "Ограничение редактирования события при запущенной рассылке",
    "type": "business_rule",
    "priority": "P1",
    "description": "Если рассылка, использующая событие, уже запущена, редактирование всех полей этого события запрещено.",
    "positive_example": "Рассылка на событие 'cart_abandoned' запущена. Попытка изменить аргументы события через API возвращает статус 409 (Conflict).",
    "negative_example": "Во время выполнения рассылки администратор успешно меняет название и аргументы связанного события.",
    "source_section_ids": [
      "section_ch1080"
    ],
    "source_quotes": [
      "Если рассылка запущена, редактирование всех полей события запрещено"
    ]
  },
  {
    "id": "EVT-005",
    "name": "Валидация типов аргументов при генерации события через API",
    "type": "functional",
    "priority": "P2",
    "description": "При генерации события через API выполняется проверка типов аргументов; при несоответствии возвращается статус 409.",
    "positive_example": "Событие 'order_created' ожидает аргумент 'order_id' типа string. Запрос с { \"order_id\": \"12345\" } успешно обрабатывается.",
    "negative_example": "Запрос на генерацию события с аргументом 'order_id': 12345 (число) возвращает ответ с кодом 409 и сообщением об ошибке типа данных.",
    "source_section_ids": [
      "section_ch1085"
    ],
    "source_quotes": [
      "При генерации через API выполняется проверка типов аргументов; при ошибке возвращается статус 409"
    ]
  },
  {
    "id": "EVT-006",
    "name": "Немедленный запуск рассылки для существующего клиента при отложенном событии",
    "type": "functional",
    "priority": "P2",
    "description": "Если для номера телефона генерируется отложенное событие, но клиент с этим номером уже существует и подтвержден, рассылка начинается сразу.",
    "positive_example": "Генерация отложенного события 'welcome' по номеру +79001234567 с ttl=24h. Клиент с этим номером уже есть в системе. Рассылка запускается немедленно, без ожидания.",
    "negative_example": "Для существующего подтвержденного клиента система все равно ждет 24 часа перед запуском рассылки по отложенному событию.",
    "source_section_ids": [
      "section_ch1103"
    ],
    "source_quotes": [
      "Если клиент уже существует, рассылка начнется сразу"
    ]
  },
  {
    "id": "EVT-007",
    "name": "Учет приоритета мессенджеров для отложенных событий",
    "type": "functional",
    "priority": "P2",
    "description": "При генерации отложенного события по номеру телефона, если клиент подтвердит номер в течение ttl, приоритет мессенджеров учитывается среди подтвержденных мессенджеров этого клиента.",
    "positive_example": "Отложенное событие сгенерировано для номера +79001234567. Клиент подтверждает Telegram и WhatsApp. Рассылка отправляется через Telegram, если он первый в messengers_order.",
    "negative_example": "Рассылку отправляют через SMS, несмотря на то, что клиент подтвердил Telegram и он имеет более высокий приоритет в настройках.",
    "source_section_ids": [
      "section_ch1103"
    ],
    "source_quotes": [
      "приоритет мессенджеров учитывается среди подтвержденных"
    ]
  },
  {
    "id": "EVT-008",
    "name": "Возврат идентификаторов запусков при генерации события",
    "type": "functional",
    "priority": "P3",
    "description": "При успешной генерации события (через интерфейс или API) возвращаются идентификаторы запусков рассылок (flow) или отложенных событий.",
    "positive_example": "Генерация события 'payment_received' возвращает ответ { \"flow_ids\": [\"flow_abc123\"], \"delayed_event_ids\": [] }.",
    "negative_example": "После генерации события ответ пустой или содержит только сообщение об успехе без идентификаторов.",
    "source_section_ids": [
      "section_ch1140"
    ],
    "source_quotes": [
      "При генерации событий возвращаются идентификаторы запусков (flow) или отложенных событий"
    ]
  },
  {
    "id": "UI-001",
    "name": "Генерация события для тестирования через интерфейс",
    "type": "ui",
    "priority": "P3",
    "description": "Интерфейс консоли маркетолога предоставляет возможность сгенерировать событие для тестирования и перейти к отладке рассылки по полученным идентификаторам запуска.",
    "positive_example": "В разделе 'Тестирование рассылок' пользователь заполняет форму аргументов события и нажимает 'Сгенерировать'. После успеха появляются ссылки на отладку запусков.",
    "negative_example": "После генерации события интерфейс не предоставляет никакой информации об идентификаторах запусков или возможности перейти к отладке.",
    "source_section_ids": [
      "section_ch1085"
    ],
    "source_quotes": [
      "Описание возможности генерации событий для тестирования через интерфейс консоли маркетолога. Позволяет сгенерировать событие и перейти к отладке рассылки по полученным идентификаторам запуска"
    ]
  },
  {
    "id": "UI-002",
    "name": "Копирование curl-запроса из интерфейса",
    "type": "ui",
    "priority": "P3",
    "description": "В интерфейсе генерации событий для тестирования есть кнопки для копирования запроса в формате curl.",
    "positive_example": "Рядом с результатом генерации события есть кнопка 'Скопировать curl', которая помещает в буфер обмена готовую curl-команду для повторения запроса через API.",
    "negative_example": "Пользователь должен вручную составлять curl-запрос на основе данных из интерфейса.",
    "source_section_ids": [
      "section_ch1085"
    ],
    "source_quotes": [
      "Также есть кнопки для копирования запроса в формате curl"
    ]
  }
]