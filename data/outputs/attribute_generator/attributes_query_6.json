[
  {
    "id": "EVT-001",
    "name": "Условная отправка вопроса",
    "type": "functional",
    "priority": "P1",
    "description": "Вопрос в форме должен отправляться клиенту только в том случае, если выполнено заданное условие, проверяющее ответ на предыдущий вопрос.",
    "positive_example": "Если задано условие 'отправить вопрос B, если на вопрос A дан ответ \"низкая оценка\"', то вопрос B отправляется только при ответе \"низкая оценка\" на вопрос A.",
    "negative_example": "Вопрос B отправляется клиенту, даже если на вопрос A дан ответ \"высокая оценка\", что не соответствует условию.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Вопрос отправляется только при выполнении условия, например, если клиент дал низкую оценку."
    ]
  },
  {
    "id": "EVT-002",
    "name": "Порядок условных вопросов",
    "type": "business_rule",
    "priority": "P1",
    "description": "Условный вопрос, отправка которого зависит от ответа на другой вопрос, должен располагаться в форме после того вопроса, ответ на который проверяется.",
    "positive_example": "Вопрос с условием проверки ответа на вопрос 'Оценка' расположен после вопроса 'Оценка'.",
    "negative_example": "Вопрос с условием проверки ответа на вопрос 'Оценка' расположен перед вопросом 'Оценка', что делает проверку невозможной.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Условный вопрос должен располагаться после вопроса, ответ на который проверяется."
    ]
  },
  {
    "id": "EVT-003",
    "name": "Обработка пропущенного ответа для условия 'Не равно'",
    "type": "functional",
    "priority": "P2",
    "description": "Если ответ на вопрос, который проверяется в условии, был пропущен клиентом, то все условия с оператором 'Не равно' должны срабатывать (считаться выполненными) при любом значении, с которым идёт сравнение.",
    "positive_example": "Условие 'отправить вопрос B, если ответ на вопрос A не равен \"Да\"' срабатывает и отправляет вопрос B, когда ответ на вопрос A пропущен.",
    "negative_example": "Условие 'отправить вопрос B, если ответ на вопрос A не равен \"Да\"' не срабатывает, когда ответ на вопрос A пропущен, и вопрос B не отправляется.",
    "source_section_ids": [
      "section_ch1344"
    ],
    "source_quotes": [
      "Если ответ на проверяемый вопрос был пропущен, все условия 'Не равно' срабатывают при любом значении сравнения."
    ]
  },
  {
    "id": "EVT-004",
    "name": "Доступность ответов как макросов в Jinja-шаблонах",
    "type": "functional",
    "priority": "P1",
    "description": "Ответы на вопросы формы должны быть доступны для использования в Jinja-шаблонах через синтаксис {{ form.<идентификатор_ответа> }}.",
    "positive_example": "В тексте шаблона письма используется конструкция {{ form.customer_feedback }} для подстановки ответа на вопрос с идентификатором 'customer_feedback'.",
    "negative_example": "Попытка использовать {{ form.customer_feedback }} в шаблоне возвращает ошибку или пустое значение, хотя ответ на вопрос был дан.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "В jinja-шаблонах используется {{ form.<идентификатор_ответа> }}"
    ]
  },
  {
    "id": "EVT-005",
    "name": "Доступность ответов как слотов в Jinja-выражениях",
    "type": "functional",
    "priority": "P1",
    "description": "Ответы на вопросы формы должны быть доступны для использования в Jinja-выражениях (например, в условиях) через синтаксис slots.<идентификатор_ответа>.",
    "positive_example": "Условие в логике бота использует выражение 'slots.user_rating > 3' для проверки ответа на вопрос с идентификатором 'user_rating'.",
    "negative_example": "Выражение 'slots.user_rating' в условии возвращает None или ошибку, хотя ответ на вопрос был предоставлен.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "в jinja-выражениях — slots.<идентификатор_ответа>"
    ]
  },
  {
    "id": "EVT-006",
    "name": "Ответы на неотвеченные вопросы при выходе из формы",
    "type": "functional",
    "priority": "P2",
    "description": "При выходе из формы (по таймауту или по желанию клиента) ответы на все неотвеченные вопросы должны быть равны None.",
    "positive_example": "Клиент начал заполнять форму, ответил на первый вопрос, затем вышел. Значение slots.answer2 для второго, неотвеченного вопроса равно None.",
    "negative_example": "После выхода клиента из формы, slots.answer2 для неотвеченного вопроса содержит какое-либо значение (например, пустую строку), отличное от None.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "При выходе из формы по таймауту или желанию клиента, ответы на неотвеченные вопросы равны None."
    ]
  },
  {
    "id": "EVT-007",
    "name": "Формат ответа для вопроса типа 'Файл'",
    "type": "functional",
    "priority": "P2",
    "description": "Ответ на вопрос типа 'Файл' должен представлять собой список URL-адресов загруженных файлов.",
    "positive_example": "Клиент загрузил два файла. Ответ slots.uploaded_files равен ['https://storage.example.com/file1.pdf', 'https://storage.example.com/file2.jpg'].",
    "negative_example": "Ответ на вопрос типа 'Файл' представляет собой одиночный URL-адрес в виде строки, а не список URL-адресов.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "Для вопросов типа 'Файл' ответ — список URL"
    ]
  },
  {
    "id": "EVT-008",
    "name": "Преобразование ответа-файла в строку для параметров",
    "type": "functional",
    "priority": "P3",
    "description": "При необходимости передать ответ на вопрос типа 'Файл' (список URL) в параметрах, где требуется строковое значение, должно быть возможно его преобразование с использованием Jinja-фильтров, например, slots.answer5|list|join(', ') if slots.answer5 else None.",
    "positive_example": "В параметре API используется значение: {{ slots.file_answer|list|join(', ') if slots.file_answer else '' }}, которое корректно преобразует список URL в строку, разделённую запятыми.",
    "negative_example": "Попытка передать slots.file_answer напрямую в строковый параметр вызывает ошибку типа данных, так как передаётся список, а не строка.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "для передачи в параметрах может потребоваться преобразование в строку с помощью фильтров (например, slots.answer5|list|join(', ') if slots.answer5 else None)."
    ]
  },
  {
    "id": "EVT-009",
    "name": "Наличие идентификатора ответа у вопроса",
    "type": "business_rule",
    "priority": "P1",
    "description": "Каждый вопрос в форме должен иметь заданный идентификатор ответа, который используется для доступа к ответу через form.<id> или slots.<id>.",
    "positive_example": "При создании вопроса 'Ваш email' ему задан идентификатор ответа 'user_email'. В шаблоне можно использовать {{ form.user_email }}.",
    "negative_example": "Вопрос добавлен в форму, но для него не задан идентификатор ответа, что делает невозможным обращение к его ответу в шаблонах или выражениях.",
    "source_section_ids": [
      "section_ch1393"
    ],
    "source_quotes": [
      "Идентификатор ответа задается в настройках вопроса."
    ]
  }
]